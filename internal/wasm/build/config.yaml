root: /
targets:
  - library: zetasql
    path: zetasql/parser
    name: parser
  - library: zetasql
    path: zetasql/public
    name: analyzer
  - library: zetasql
    path: zetasql/public
    name: catalog
  - library: zetasql
    path: zetasql/public
    name: simple_catalog
  - library: zetasql
    path: zetasql/public
    name: sql_formatter
ignores:
  - path: bazel
    name: flex
  - path: external
    name: python_headers
  - path: protobuf
    name: timestamp_proto
libraries:
  - name: zetasql
    root: zetasql
  - name: com_google_absl
    root: external/com_google_absl
  - name: com_google_googletest
    root: external/com_google_googletest
  - name: com_google_protobuf
    root: external/com_google_protobuf
  - name: com_google_googleapis
    root: external/com_google_googleapis
  - name: boringssl
    root: external/boringssl
  - name: com_googlesource_code_re2
    root: external/com_googlesource_code_re2
  - name: icu
    root: external/icu
  - name: json
    root: external/json
  - name: com_google_cc_differential_privacy
    root: external/com_google_cc_differential_privacy
  - name: utf8_range
    root: external/utf8_range
  - name: com_github_grpc_grpc
  - name: boost
  - name: com_github_google_glog
  - name: com_google_file_based_test_driver
  - name: jsoncpp
  - name: com_google_differential_privacy
  - name: com_google_farmhash
  - name: rules_ruby
  - name: com_google_riegeli
  - name: com_github_google_benchmark
  - name: upb

output: zetasql.wasm
compiler: emcc

include_paths:
  - /external/com_google_protobuf/src
  - /external/flex_v2.6.4/src
  - /external/com_google_googletest/googletest/include
  - /external/icu/source/common
  - /external/utf8_range
  - /external/com_google_differential_privacy
  - /external/boringssl/src/include

sources:
  - bind.cc

compiler_options:
  - --no-entry
  - -fno-exceptions
  - -funsigned-char
  - -std=c++1z
  - -DU_COMMON_IMPLEMENTATION
  - -DNAMESPACE_FOR_HASH_FUNCTIONS=farmhash
  - -DHAVE_PTHREAD
  - -Wall
  - -Wextra
  - -Wno-defaulted-function-deleted
  - -Wno-invalid-constexpr
  - -Wno-range-loop-construct
  - -Wno-unused-variable
  - -Wno-unused-but-set-variable
  - -Wno-unused-private-field
  - -Wno-unused-parameter
  - -Wno-unused-but-set-parameter
  - -Wno-unused-function
  - -Wno-ignored-qualifiers
  - -Wno-array-parameter
  - -Wno-bitwise-instead-of-logical
  - -Wno-implicit-function-declaration
  - -Wno-incompatible-pointer-types-discards-qualifiers
  - -Wno-missing-field-initializers
  - -Wno-undef
  - -Wno-final-dtor-non-final-class
  - -Wno-implicit-const-int-float-conversion
  - -Wno-char-subscripts
  - -Wno-sign-compare
  - -Wno-switch
  - -Wno-deprecated-declarations
  - -Wno-inconsistent-missing-override
  - -Wno-unknown-attributes
  - -Wno-macro-redefined
  - -Wno-shift-count-overflow
  - -Wno-enum-compare-switch
  - -Wno-return-type
  - -Wno-subobject-linkage
  - -Wno-unknown-warning-option
  - -Wno-deprecated
  - -Wno-mismatched-tags

linker_options:
  - -sSTANDALONE_WASM
  - -sEXPORT_ALL
  - --emit-symbol-map
